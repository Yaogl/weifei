# 360 工业互联网攻防平台接口文档

## 待确认的内容

- 图标中安全能力情况数据来源、设备与漏洞数据来源

## 已确认的东西

1. 评估管理的状态：未评估、评估中、评估完成
2. 一个评估可以对应多个拓扑图，新建评估是同步创建拓扑和评估，评估状态为未评估，图谱状态保存时可以是草稿、和确认生成（已使用）
3. 拓扑图编辑是再保存时选择存草稿调用新增接口生成一个新的草稿，选择确认生成调用编辑接口状态传已使用

**变更记录**

| 版本  | 变更记录                                  |  作者  |    日期    |
| :---- | :---------------------------------------- | :----: | :--------: |
| 1.0.7 | 增加专业组件相关 API（topo.md line:1580） | 秦艳飞 | 2021-06-11 |
| 1.0.7 | 增加评估详情按设备类型统计的 API          | 秦艳飞 | 2021-06-08 |
| 1.0.6 | 增加攻击路径统计 API、用户权限 API        | 秦艳飞 | 2021-05-25 |
| 1.0.6 | 增加公司相关接口在 other 里               | 秦艳飞 | 2021-05-24 |
| 1.0.5 | 修改评估详情返回，增加链路总数和明细      | 秦艳飞 | 2021-05-23 |
| 1.0.4 | 增加拓扑和评估相关的接口                  | 秦艳飞 | 2021-05-20 |
| 1.0.3 | 修改设备相关 API 的返回格式               | 秦艳飞 | 2021-05-16 |
| 1.0.2 | 设备 API 增加 lable                       | 秦艳飞 | 2021-05-16 |
| 1.0.1 | 添加设备相关 API                          | 秦艳飞 | 2021-05-13 |
| 1.0.0 | 初始化                                    | 秦艳飞 | 2021-05-07 |

## 接口请求参数

- base_url:
  - dev: http://topo360.vaiwan.com/api/v1
  - prod: https://prod.360assess.com/api/v1
- method:post|get|put|delete
- header:
  - Authorization:`bearer {token}`
- body: `type:application/json`

## 接口响应格式

1. 正常返回 http 的状态码为 200，如果返回的是非 200 的状态码
2. 接口返回数据成功返回如下格式的数据,code = 200

   ```
   {
       "code": 200 ,
       "data":"string|boolean|number|object|array"
   }
   ```

3. 接口返回数据失败，返回错误码及错误提示，

   ```
   {
       "code": 400,
       "msg":"错误提示"
   }
   ```

4. 带分页的传参时当前页传 page，每页数量传 pageSize,返回的 data 部分会包含 `items`数组和`pager`对象

## token 的获取

**请求**

- uri: `/auth/login`
- method:`POST`
- body:

```
{
    "username":"user",
    "password":"123456"
}
```

**响应**

```
{
    code:0,
    msg:"",
    data:""
}
```
